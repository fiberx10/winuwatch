generator client {
  provider = "prisma-client-js"
}

generator erd {
  provider = "prisma-erd-generator"
  output   = "./erd.png"
}


datasource db {
  provider     = "mysql"
  url          = "mysql://wdwuknnzs4f66zn9palj:pscale_pw_N75DyHGPirpB80uON4TnmpVEhZi6wRX5yG5em6jcbkY@aws.connect.psdb.cloud/win-u-wath?sslaccept=strict"
  relationMode = "prisma"
}

model ImagesUrl {
  id        String  @id @default(cuid())
  url       String
  WatchesId String
  Watches   Watches @relation(fields: [WatchesId], references: [id])

  @@index([WatchesId])
  @@map("images_url")
}

model Watches {
  id                  String       @id @default(cuid())
  brand               String
  model               String
  reference_number    String
  movement            String
  Bracelet_material   String
  year_of_manifacture Int
  caliber_grear       Int
  number_of_stones    Int
  glass               String
  bezel_material      String
  has_box             Boolean      @default(false)
  has_certificate     Boolean      @default(false)
  condition           String
  images_url          ImagesUrl[]
  Competition         Competition?

  @@map("watches")
}

model Competition {
  id                       String            @id @default(cuid())
  name                     String
  max_watch_number         Int
  max_space_in_final_draw  Int
  winner_announcement_date DateTime?
  start_date               DateTime
  end_date                 DateTime
  run_up_prize             String?
  drawing_date             DateTime
  remaining_tickets        Int
  ticket_price             Float
  total_tickets            Int
  location                 String
  price                    Float
  status                   CompetitionStatus
  winner                   String?
  orderId                  String?
  second_reward            String?
  createdAt                DateTime          @default(now())
  updatedAt                DateTime          @updatedAt
  watchesId                String            @unique
  Watches                  Watches           @relation(fields: [watchesId], references: [id])
  Order                    Order?            @relation(fields: [orderId], references: [id])
  Ticket                   Ticket[]

  @@index([orderId])
  @@map("competition")
}

model Order {
  id            String        @id @default(cuid())
  first_name    String
  last_name     String
  country       String
  address       String
  town          String
  zip           String
  phone         String
  email         String
  date          DateTime
  paymentMethod PaymentMethod
  checkedEmail  Boolean
  checkedTerms  Boolean
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  totalPrice    Float
  status        OrderStatus
  Competition   Competition[]
  Ticket        Ticket[]

  @@map("order")
}

model Ticket {
  id            String      @id @default(cuid())
  orderId       String
  competitionId String
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  Order         Order       @relation(fields: [orderId], references: [id])
  Competition   Competition @relation(fields: [competitionId], references: [id])

  @@index([competitionId])
  @@index([orderId])
  @@map("tickets")
}

model Question {
  id            String   @id @default(cuid())
  question      String
  correctAnswer String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  answers       answer[]

  @@map("question")
}

model answer {
  id         String   @id @default(cuid())
  answer     String
  questionId String
  Question   Question @relation(fields: [questionId], references: [id])

  @@index([questionId])
  @@map("answers")
}

enum OrderStatus {
  PENDING
  CONFIRMED
  CANCELLED
}

enum PaymentMethod {
  PAYPAL
  STRIPE
}

enum CompetitionStatus {
  ACTIVE
  NOT_ACTIVE
  COMPLETED
}
